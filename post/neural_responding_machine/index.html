<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.45" />
  <meta name="author" content="Zhang Hao">

  
  
  
  
    
      
    
  
  <meta name="description" content="The paper, Neural Responding Machine for Short-Text Conversation, published by L Shang et. al. in 2015, introduces Neural Responding Machine (NRM), a neural network-based response generator for short-text conversation. The NRM takes the general encoder-decoder framework, which formalizes the generation of response as a decoding process based on the latent representation of the input text, while both encoding and decoding are realized with recurrent neural networks (RNN). In this paper, the author demonstrates that the proposed encoder-decoder-based neural network overperform the traditional Retrivial-based methods and Statistical Machine Translation (SMT) based methods.">

  
  <link rel="alternate" hreflang="en-us" href="https://isaacchanghau.github.io/post/neural_responding_machine/">

  


  

  
  
  <meta name="theme-color" content="#3f51b5">
  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Playfair&#43;Display:400,700%7cFauna&#43;One">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="https://isaacchanghau.github.io/index.xml" type="application/rss+xml" title="Isaac Changhau">
  <link rel="feed" href="https://isaacchanghau.github.io/index.xml" type="application/rss+xml" title="Isaac Changhau">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://isaacchanghau.github.io/post/neural_responding_machine/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@https://twitter.com/IsaacChanghau">
  <meta property="twitter:creator" content="@https://twitter.com/IsaacChanghau">
  
  <meta property="og:site_name" content="Isaac Changhau">
  <meta property="og:url" content="https://isaacchanghau.github.io/post/neural_responding_machine/">
  <meta property="og:title" content="Neural Responding Machine for Short-Text Conversation -- Summary | Isaac Changhau">
  <meta property="og:description" content="The paper, Neural Responding Machine for Short-Text Conversation, published by L Shang et. al. in 2015, introduces Neural Responding Machine (NRM), a neural network-based response generator for short-text conversation. The NRM takes the general encoder-decoder framework, which formalizes the generation of response as a decoding process based on the latent representation of the input text, while both encoding and decoding are realized with recurrent neural networks (RNN). In this paper, the author demonstrates that the proposed encoder-decoder-based neural network overperform the traditional Retrivial-based methods and Statistical Machine Translation (SMT) based methods.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2017-07-19T00:00:00&#43;08:00">
  
  <meta property="article:modified_time" content="2017-07-19T00:00:00&#43;08:00">
  

  

  <title>Neural Responding Machine for Short-Text Conversation -- Summary | Isaac Changhau</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Isaac Changhau</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#tags">
            
            <span>Tags</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#achievements">
            
            <span>Achievements</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Neural Responding Machine for Short-Text Conversation -- Summary</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-07-19 00:00:00 &#43;0800 &#43;08" itemprop="datePublished dateModified">
      Wed, Jul 19, 2017
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhang Hao">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  

  

  
  

  

</div>

    
    <div class="article-style" itemprop="articleBody">
      

<p>The paper, <a href="https://arxiv.org/pdf/1503.02364.pdf" target="_blank">Neural Responding Machine for Short-Text Conversation</a>, published by L Shang et. al. in 2015, introduces Neural Responding Machine (NRM), a neural network-based response generator for short-text conversation. The NRM takes the general encoder-decoder framework, which formalizes the generation of response as a decoding process based on the latent representation of the input text, while both encoding and decoding are realized with recurrent neural networks (RNN). In this paper, the author demonstrates that the proposed encoder-decoder-based neural network overperform the traditional <strong>Retrivial-based methods</strong> and <strong>Statistical Machine Translation (SMT) based methods</strong>.</p>

<h2 id="dataset-for-short-text-conversation">Dataset for Short-Text Conversation</h2>

<p>The author prepares around <strong>4.4 million pairs</strong> of conversations from <a href="http://www.weibo.com/" target="_blank">Weibo</a> to train the model. And the dataset is derived from hundreds of millions of post-response pairs by cleaning this raw data including:</p>

<ul>
<li>removing trivial responses like &ldquo;wow&rdquo;</li>
<li>filtering out potential advertisements</li>
<li>removing the response after first 30 ones for topic consistency.</li>
</ul>

<p>Below is some statistics of the dataset used:
<img src="/img/nlp/NRM/dataset.png" alt="Dataset Overview" /></p>

<h2 id="neural-responding-machines">Neural Responding Machines</h2>

<p>The neural responding machine generally contains three parts, <em>encoder</em>, <em>context generator</em> and <em>decoder</em>, as shown in the graph below. Here, both encoder and decoder are <strong>Recurrent Neural Networks</strong>, beasue of its natural ability to summarize and generate word sequence of arbitrary lengths.
<img src="/img/nlp/NRM/framework.png" alt="Framework" />
where $\mathbf{x}=(x_{1},\dots,x_{T})$ is the input sequence ($x_{i}$ denotes the $i$-th word), $\mathbf{h}=(h_{1},\dots,h_{T})$ is a set of high-dimensional hidden representations, $\alpha_{t}$ is the attention signal at time $t$, while $c_{t}$ is the context at time $t$, $y_{t}$ is the generated $t$-th word of response. And the general process is:</p>

<ol>
<li>The encoder converts the input sequence $\mathbf{x}$ into the hidden representations $\mathbf{h}$;</li>
<li>$\mathbf{h}$, along with attention signal $\alpha_{t}$, are fed to the context-generator to build the context $c_{t}$ input to decoder at time $t$.</li>
<li>The $c_{t}$ is linearly transformed by the transformation matrix $\mathbf{L}$ into a stimulus of generating RNN to produce the $t$-th word $y_{t}$ of response.</li>
</ol>

<p>Here $\mathbf{L}$ performs the role to transform the representation of post (or some part of it) to the rich representation of many plausible responses, while $\alpha_{t}$ is to determine which part of the hidden representation $\mathbf{h}$ should be emphasized during the generation process, normally, $\alpha_{t}$ is function of historically generated subsequence $(y_{1},\dots,y_{t-1})$, $\mathbf{x}$ or their latent representations.</p>

<h3 id="encoder-and-context-generator">Encoder and Context Generator</h3>

<p>The author introduces three types of encoding schemes: global scheme, local scheme and hybrid scheme (combination of global and local schemes). And the context generator of each scheme is different.</p>

<h4 id="global-scheme">Global Scheme</h4>

<p>Graph below visualizes the global scheme of the RNN-encoder and related context generator.
<img src="/img/nlp/NRM/global.png" alt="Global Scheme" />
The hidden state at time $t$ is computed by $h_{t}=\mathcal{f}(x_{t},h_{t-1})$, while the context generator simply uses the last hidden state as the context vector, i.e, $c_{t}=h_{T}$, it means that final hidden state $h_{T}$ is used as the global representation of the sentence. However, this scheme has drawbacks that <strong>a vectorial summarization of the entire post is often hard to obtain and may lose important details for response generation, especially when the dimension of the hidden state is not big enough</strong>.
It is worth to mentione that $\mathcal{f}(\centerdot)$ can be a logistic function, sophisticated <a href="https://arxiv.org/pdf/1503.04069.pdf" target="_blank">Long Short-Term Memory (LSTM) unit</a>, or <a href="https://arxiv.org/pdf/1412.3555.pdf" target="_blank">Gated Recurrent Unit (GRU)</a>. Compared to &ldquo;Ungated&rdquo; or vanilla logistic function, LSTM and GRU are specially designed for its long term memory, which is able to store information over extended time steps without too much decay. The author chooses GRU for this task, due to its performance comparable to LSTM on sequence modeling, but less parameters and easier to train.</p>

<h4 id="local-scheme">Local Scheme</h4>

<p>Local scheme introduces an attention mechanism, which allows the encoder to dynamically select and linearly combine different parts of the input sequence, say, the contect vector here is computed by
$$
c_{t}=\sum_{j=1}^{T}\alpha_{tj}h_{j}
$$
where weighting factor $\alpha_{tj}$ is the attention signal to determine which part should be selected to generate the rew word $y_{t}$, which in turn is a function of hidden states $\alpha_{tj}=q(h_{j},s_{t-1})$, $s_{t-1}$ is the hidden state of decoder at time $t-1$, will be introduced later, graph of local scheme is shown below:
<img src="/img/nlp/NRM/local.png" alt="Local Scheme" />
Basically, the attention mechanism $\alpha_{tj}$ models the alignment between the inputs around position $j$ and the output at position $t$, so it can be viewed as a local matching model. This scheme enjoys <strong>the advantage of adaptively focusing on some important words of the input text according to the generated words of response</strong>, i.e., it cover the deficit that global scheme lost some important information.</p>

<h4 id="hybrid-scheme">Hybrid Scheme</h4>

<p>As mentioned before, global scheme has the summarization of the entire post, while local scheme can adaptively select the important words in post for various suitable responses. Since post-response pairs in STC are not strictly parallel and a word in different context can have different meanings, the author assumes that the global representation in may provide useful context for extracting the local context, therefore complementary to the local scheme. Thus, <strong>hybrid scheme is therefore to combine the global and local schemes by concatenating their encoded hidden states to form an extended hidden representation for each time stamp</strong>, as shown below:
<img src="/img/nlp/NRM/hybrid.png" alt="Hybrid Scheme" />
Here the summarization $h_{T}^{g}$ is incorporated into $c_{t}$ and $\alpha_{tj}$ to provide a global context for local matching, thus the context generator function is
$$
c_{t}=\sum_{j=1}^{T}\alpha_{tj}\big[h_{j}^{l};h_{T}^{g}\big]
$$
where $\big[h_{j}^{l};h_{T}^{g}\big]$ denotes the concatenation of vectors $h_{j}^{l}$ and $h_{T}^{g}$. The author also mention that the context generator in hybrid scheme will evoke different encoding mechanisms in the global encoder and the local encoder, although they will be combined later in forming a unified representation. More specifically, the last hidden state of global scheme plays a role different from that of the last state of local scheme, since it has the responsibility to encode the entire input sentence. This role of global scheme, however, tends to be not adequately emphasized in training the hybrid encoder when the parameters of the two encoding RNNs are learned jointly from scratch. For this the author first initialize hybrid scheme with the parameters of local scheme and global scheme trained separately, then fine ture the parameters in encoder along with training the parameters of decoder.</p>

<h3 id="decoder">Decoder</h3>

<p>The graph of decoder is shown below, which is essentially a standard RNN language model except conditioned on the context input $\mathbf{c}$.
<img src="/img/nlp/NRM/decoder.png" alt="Decoder Scheme" />
The generation probability of the $t$-th word is computed by
$$
p(y_{t}|y_{t-1},\dots,y_{1},\mathbf{x})=\mathcal{g}(y_{t-1},s_{t},c_{t})
$$
where $y_{t}$ is a one-hot word representation, $\mathcal{g}(\centerdot)$ is a softmax activation function, and $s_{t}$ is the hidden state of decoder at time $t$ computed by$$s_{t}=\mathcal{f}(y_{t-1},s_{t-1},c_{t})$$and $\mathcal{f}(\centerdot)$ is a non-linear activation function (i.e., still GRU unit), and the transformation $\mathbf{L}$ is often assigned as parameters of $\mathcal{f}(\centerdot)$.</p>

<p>To learn the parameters of the model, the target is to maximize the likelihood of observing the original response conditioned on the post in the training set. While for a new post, NRMs generate their responses by using a left-to-right <a href="https://en.wikipedia.org/wiki/Beam_search" target="_blank">beam search</a> with beam size = 10.</p>

<h2 id="implementation-details-and-experiments">Implementation Details and Experiments</h2>

<p>The author uses <a href="https://nlp.stanford.edu/software/segmenter.shtml" target="_blank">Stanford Chinese word segmenter</a> to split the posts and responses into sequences of words. Since the number of unique words in post text is 125,237, and that of response text is 679,958. The author therefore construct two separate vocabularies for posts and responses by using <strong>40,000</strong> most frequent words on each side, covering 97.8% usage of words for post and 96.2% for response respectively. All the remaining words are replaced by a special token “UNK”. The dimensions of the hidden states of encoder and decoder are both <strong>1000</strong>, and the dimensions of the word-embedding for post and response are both <strong>620</strong>. Model parameters are initialized by randomly sampling from a uniform distribution between -0.1 and 0.1. Models are trained by stochastic gradient descent algorithm with mini-batch.
Below shows the responses generated by different models, where <em>NRM-glo</em> denotes global scheme, <em>NRM-loc</em> represents local scheme and <em>NRM-hyb</em> is the hybrid scheme, while <em>Rtr.-based</em> represents the Retrieval-based method used as a competitor.
<img src="/img/nlp/NRM/result.png" alt="Result" />
Above is a general summary of the paper: &ldquo;Neural Responding Machine for Short-Text Conversation&rdquo;, I only describe the algorithm introduced in this paper, and I am trying to build this model by myself in the furture.</p>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/deep-learning">deep-learning</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/natural-language-processing">natural-language-processing</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/seq2seq">seq2seq</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/post/word2vecf/">Word2Vecf -- Dependency-Based Word Embeddings and Lexical Substitute</a></li>
        
        <li><a href="/post/word2vec/">Word2Vec -- Mathematical Principles and Java Implementation</a></li>
        
        <li><a href="/post/understand_lstm/">Understanding LSTM Networks</a></li>
        
        <li><a href="/post/loss_functions/">Loss Functions in Neural Networks</a></li>
        
        <li><a href="/post/parameters_update/">Parameter Update Methods in Neural Networks</a></li>
        
      </ul>
    </div>
    

    

    


  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017-2018 &middot; 

      <strong>Isaac Changhau (Zhang Hao)</strong>
      

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/c.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/html.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/xml.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ 
          tex2jax: { 
            inlineMath: [['$','$'], ['\\(','\\)']] 
          } 
        });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-xAWI9i8WMRLdgksuhaMCYMTw9D+MEc2cYVBApWwGRJ0cdcywTjMovOfJnlGt9LlEQj6QzyMzpIZLMYujetPcQg==" crossorigin="anonymous"></script>
    
    
    

  </body>
</html>

